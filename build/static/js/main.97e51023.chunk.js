(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{114:function(e,t){},127:function(e,t,a){e.exports=a(231)},132:function(e,t,a){},157:function(e,t){},180:function(e,t){},182:function(e,t){},189:function(e,t,a){},231:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),o=a.n(c),i=(a(132),a(32)),s=a(6),l=a(252),u=function(e){return r.a.createElement("button",{onClick:function(){var t=Object(l.a)();e.history.push("/room/".concat(t))}},"Create room")},m=a(45),p=a(22),d=a(23),h=a(28),f=a(26),E=a(107),v=a(108),b=a.n(v),g=a(66),_=a.n(g),O=a(110),j=(a(189),a(12)),y=a(39);function k(){var e=Object(E.a)(["\n  height: 40%;\n  width: 50%;\n"]);return k=function(){return e},e}var N=O.a.video(k()),S=function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){e.peer.on("stream",(function(e){t.current.srcObject=e}))}),[]),r.a.createElement(N,{playsInline:!0,autoPlay:!0,ref:t})},R=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).muteUnmute=function(){var e=n.userVideo.current.srcObject.getAudioTracks()[0].enabled;n.userVideo.current.srcObject.getAudioTracks()[0].enabled=!e},n.playStop=function(){var e=n.userVideo.current.srcObject.getVideoTracks()[0].enabled;n.userVideo.current.srcObject.getVideoTracks()[0].enabled=!e},n.socketRef=r.a.createRef(),n.userVideo=r.a.createRef(),n.state={peers:[],roomID:n.props.match.params.roomId,peersRef:[]},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.socketRef.current=b.a.connect("https://education-in.herokuapp.com/"),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){e.userVideo.current.srcObject=t,e.socketRef.current.emit("join room",e.state.roomID,e.props.auth.user.id),e.socketRef.current.on("all users",(function(a){a.forEach((function(a){var n=e.createPeer(a,e.socketRef.current.id,t);e.setState({peers:[].concat(Object(m.a)(e.state.peers),[n]),peersRef:[].concat(Object(m.a)(e.state.peersRef),[{peerID:a,peer:n}])})}))})),e.socketRef.current.on("user joined",(function(a){var n=e.addPeer(a.signal,a.callerID,t);e.setState({peers:[].concat(Object(m.a)(e.state.peers),[n]),peersRef:[].concat(Object(m.a)(e.state.peersRef),[{peerID:a.callerID,peer:n}])})})),e.socketRef.current.on("receiving returned signal",(function(t){e.state.peersRef.find((function(e){return e.peerID===t.id})).peer.signal(t.signal)}))}))}},{key:"createPeer",value:function(e,t,a){var n=this,r=new _.a({initiator:!0,trickle:!1,stream:a});return r.on("signal",(function(a){n.socketRef.current.emit("sending signal",{userToSignal:e,callerID:t,signal:a})})),r}},{key:"addPeer",value:function(e,t,a){var n=this,r=new _.a({initiator:!1,trickle:!1,stream:a});return r.on("signal",(function(e){n.socketRef.current.emit("returning signal",{signal:e,callerID:t})})),r.signal(e),r}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"main"},r.a.createElement("div",{className:"main__left"},r.a.createElement("div",{className:"main__videos"},r.a.createElement("div",{id:"video-grid"},r.a.createElement(N,{muted:!0,ref:this.userVideo,autoPlay:!0,playsInline:!0}),this.state.peers.map((function(e,t){return r.a.createElement(S,{key:t,peer:e})})))),r.a.createElement("div",{className:"main__controls"},r.a.createElement("div",{className:"main__controls__block"},r.a.createElement("div",{onClick:function(){return e.muteUnmute()},className:"main__controls__button main__mute_button"},r.a.createElement("i",{className:"fas fa-microphone"}),r.a.createElement("span",null,"Mute")),r.a.createElement("div",{onClick:function(){return e.playStop()},className:"main__controls__button main__video_button"},r.a.createElement("i",{className:"fas fa-video"}),r.a.createElement("span",null,"Stop Video"))),r.a.createElement("div",{className:"main__controls__block"},r.a.createElement("div",{className:"main__controls__button"},r.a.createElement("i",{className:"fas fa-shield-alt"}),r.a.createElement("span",null,"Security")),r.a.createElement("div",{className:"main__controls__button"},r.a.createElement("i",{className:"fas fa-user-friends"}),r.a.createElement("span",null,"Participants")),r.a.createElement("div",{className:"main__controls__button"},r.a.createElement("i",{className:"fas fa-comment-alt"}),r.a.createElement("span",null,"Chat"))),r.a.createElement("div",{className:"main__controls__block"},r.a.createElement("div",{className:"main__controls__button"},r.a.createElement("span",{className:"leave_meeting"},"Leave Meeting"))))),r.a.createElement("div",{className:"main__right"},r.a.createElement("div",{className:"main__header"},r.a.createElement("h6",null,"Chat")),r.a.createElement("div",{className:"main__chat_window"},r.a.createElement("ul",{className:"messages"})),r.a.createElement("div",{className:"main__message_container"},r.a.createElement("input",{id:"chat_message",type:"text",placeholder:"Type message here..."}))))}}]),a}(n.Component),C=Object(j.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,auth:e.auth,error:e.errors}}),{})(Object(y.a)((function(e){return{}}))(R)),A=a(29),L=a.n(A),I="https://education-in2.herokuapp.com",w="".concat(I).concat("/api"),D="".concat(I).concat("/api/auth"),T=("".concat(D,"/login"),"".concat(D,"/getClass")),U=function(e){var t=e().auth.token,a={headers:{"Content-Type":"application/json"}};return t&&(a.headers.Authorization="Token ".concat(t)),a},G=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,this.props.auth.isAuthenticated?r.a.createElement("div",null,r.a.createElement("button",{onClick:this.props.logout},"logout")," ",r.a.createElement(i.b,{to:"/create"},"Create meeting")," "):r.a.createElement(i.b,{to:"/login"},"Login"))}}]),a}(n.Component),P=Object(j.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,auth:e.auth,error:e.errors}}),{logout:function(){return function(e,t){L.a.post("".concat(I,"/api/auth/logout"),null,U(t)).then((function(t){e({type:"LOGOUT_SUCCESS",payload:t.data})})).catch((function(e){console.log(e)}))}}})(G),V=a(55),F=a(114),M=a(250),x=function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).onSubmit=function(e){e.preventDefault(),n.props.login(n.state.username,n.state.password)},n.onChange=function(e){n.setState(Object(V.a)({},e.target.name,e.target.value))},n.state={username:"",password:"",prop:n.props,path:"/"},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){void 0!==this.state.prop.location.state&&this.setState({path:this.state.prop.location.state.pathname})}},{key:"nothing",value:function(){}},{key:"render",value:function(){if(this.props.isAuthenticated)return r.a.createElement(s.a,{to:"/"});var e=this.state,t=e.username,a=e.password;return r.a.createElement("div",null,this.props.error.msg.username?r.a.createElement(M.a,{variant:"primary"},"Fill the Email"):r.a.createElement("div",null),this.props.error.msg.password?r.a.createElement(M.a,{variant:"primary"},"Fill the Password"):r.a.createElement("div",null),this.props.error.msg.non_field_errors?r.a.createElement(M.a,{variant:"primary"},"Fill Correct Password and Email"):r.a.createElement("div",null),r.a.createElement("div",{className:"col-md-6 m-auto"},r.a.createElement("div",{className:"card card-body mt-5"},r.a.createElement("h2",{className:"text-center"},"Login"),r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Username"),r.a.createElement("input",{className:"form-control",name:"username",onChange:this.onChange,value:t,required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",className:"form-control",name:"password",onChange:this.onChange,value:a,required:!0})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{onClick:this.redirect,type:"submit",className:"btn btn-primary"},"Login"))))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null))}}]),a}(n.Component),J=Object(s.g)(Object(j.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,auth:e.auth,error:e.errors}}),{login:function(e,t){return function(a){var n=JSON.stringify({username:e,password:t});L.a.post("".concat(I,"/api/auth/login"),n,{headers:{"Content-Type":"application/json"}}).then((function(e){a({type:"LOGIN_SUCCESS",payload:e.data})})).catch((function(e){var t={msg:e.response.data,status:e.response.status};a({type:"LOGIN_FAIL",payload:t})}))}},loadStudentProfile:F.loadStudentProfile})(x)),W=a(251),q=(L.a.create({baseURL:w,headers:{"Content-Type":"application/json"}}),function(e){Object(h.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={classListData:[]},e.createRoom=function(t){e.props.history.push("/room/".concat(t))},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e,t=this;(e=this.props.auth.token,L.a.create({baseURL:w,headers:{"Content-Type":"application/json",Authorization:"Token ".concat(e)}})).get("".concat(T)).then((function(e){return t.setState({classListData:e.data})}))}},{key:"render",value:function(){var e=this;this.props.classes;return r.a.createElement("div",{className:"container",style:{marginTop:40}},this.state.classListData.map((function(t){return r.a.createElement("div",null,t.name,r.a.createElement(W.a,{onClick:function(){return e.createRoom(t.id)},variant:"contained",color:"primary"},"Enter"))})))}}]),a}(n.Component)),z=Object(j.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,auth:e.auth,error:e.errors}}),{})(Object(y.a)((function(e){return{}}))(q)),B=a(124),H=Object(j.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.component,a=e.auth,n=Object(B.a)(e,["component","auth"]);return r.a.createElement(s.b,Object.assign({},n,{render:function(e){return a.isLoading?void 0:a.isAuthenticated?r.a.createElement(t,e):r.a.createElement(s.a,{to:{pathname:"/",state:e.location}})}}))}));var $=function(){return r.a.createElement(n.Fragment,null,r.a.createElement(i.a,null,r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/",exact:!0,component:P}),r.a.createElement(H,{path:"/classes",component:z}),r.a.createElement(s.b,{path:"/create",component:u}),r.a.createElement(s.b,{path:"/room/:roomId",component:C}),r.a.createElement(s.b,{path:"/login",component:J}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(211);var K=a(249),Q=a(117),X=a(248),Y=a(121),Z=a.n(Y),ee=a(65),te=a.n(ee),ae=a(24),ne=a(119),re=a(120),ce=a(15),oe={token:localStorage.getItem("token"),isAuthenticated:null,isLoading:!1,user:null},ie={msg:{},status:null},se=Object(ae.combineReducers)({errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_FAIL":case"REGISTER_FAIL":return{msg:t.payload.msg,status:t.payload.status};default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOADING":return Object(ce.a)(Object(ce.a)({},e),{},{isLoading:!0});case"USER_LOADED":return Object(ce.a)(Object(ce.a)({},e),{},{isAuthenticated:!0,isLoading:!1,user:t.payload});case"LOGIN_SUCCESS":return localStorage.setItem("token",t.payload.token),Object(ce.a)(Object(ce.a)(Object(ce.a)({},e),t.payload),{},{isAuthenticated:!0,isLoading:!1});case"REGISTER_SUCCESS":case"REGISTER_FAIL":return Object(ce.a)(Object(ce.a)({},e),{},{isAuthenticated:!0,isLoading:!1});case"AUTH_ERROR":case"LOGIN_FAIL":case"LOGOUT_SUCCESS":return Object(ce.a)(Object(ce.a)({},e),{},{token:null,user:null,isAuthenticated:!1,isLoading:!1});default:return e}}}),le=[re.a],ue=Object(ae.createStore)(se,{},Object(ne.composeWithDevTools)(ae.applyMiddleware.apply(void 0,le)));ue.dispatch((function(e,t){e({type:"USER_LOADING"}),L.a.get("".concat(I,"/api/auth/user"),U(t)).then((function(t){e({type:"USER_LOADED",payload:t.data})})).catch((function(t){e({type:"AUTH_ERROR"})}))}));var me=Z()({palette:{primary:{main:te.a[700]}}});o.a.render(r.a.createElement(j.a,{store:ue},r.a.createElement(X.a,{theme:me},r.a.createElement(K.a,{utils:Q.a},r.a.createElement($,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[127,1,2]]]);
//# sourceMappingURL=main.97e51023.chunk.js.map